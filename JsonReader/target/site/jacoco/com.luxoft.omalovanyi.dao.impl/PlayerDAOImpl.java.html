<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ru"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>PlayerDAOImpl.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jsonreader</a> &gt; <a href="index.source.html" class="el_package">com.luxoft.omalovanyi.dao.impl</a> &gt; <span class="el_source">PlayerDAOImpl.java</span></div><h1>PlayerDAOImpl.java</h1><pre class="source lang-java linenums">package com.luxoft.omalovanyi.dao.impl;

import com.luxoft.omalovanyi.dao.PlayerDAO;
import com.luxoft.omalovanyi.model.Player;
import com.luxoft.omalovanyi.util.Utility;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Component;
import org.springframework.transaction.annotation.Transactional;

import javax.sql.DataSource;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.ParseException;
import java.util.ArrayList;
import java.util.List;

/**
 * Created by maoleks on 6/10/2016.
 */
@Component
<span class="fc" id="L23">public class PlayerDAOImpl implements PlayerDAO {</span>

    private JdbcTemplate jdbcTemplate;


    @Autowired
    public void setDataSource(DataSource dataSource) {
<span class="fc" id="L30">        this.jdbcTemplate = new JdbcTemplate(dataSource);</span>
<span class="fc" id="L31">    }</span>

    @Override
    public void insertListPlayers(List&lt;Player&gt; listPlayers) {

<span class="fc" id="L36">        String sql = &quot;insert into UEFA2016 (name,bio,is_photo,is_spec_player,position,number_player,caps,cnt_goals,club,league,date_birthday,rating_match1,rating_match2,rating_match3) &quot; +</span>
                &quot;VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?)&quot;;

<span class="fc" id="L39">        List&lt;Object[]&gt; inputList = new ArrayList&lt;Object[]&gt;();</span>

<span class="fc bfc" id="L41" title="All 2 branches covered.">        for (Player player : listPlayers) {</span>
<span class="fc" id="L42">            Object[] tmp = new Object[0];</span>
<span class="fc" id="L43">                tmp = new Object[]{</span>
                        player.getName(),
                        player.getBiography(),
                        player.getPhotoInclude(),
                        player.getSpecialPlayer(),
                        player.getPosition(),
                        Integer.valueOf(player.getNumber()),
                        Integer.valueOf(player.getCaps()),
                        Integer.valueOf(player.getCountGoals()),
                        player.getClub(),
                        player.getLeague(),
                        Utility.stringToDate(player.getDateBirthday()),
                        player.getRating_match1(),
                        player.getRating_match2(),
                        player.getRating_match3()
                };
<span class="fc" id="L59">            inputList.add(tmp);</span>
<span class="fc" id="L60">        }</span>
<span class="fc" id="L61">        int[] updateCounts = jdbcTemplate.batchUpdate(sql, inputList);</span>
<span class="fc" id="L62">    }</span>

    @Override
    public void clearListPlayers() {
<span class="fc" id="L66">        String sql = &quot;delete from UEFA2016&quot;;</span>
<span class="fc" id="L67">        jdbcTemplate.update(sql);</span>

<span class="fc" id="L69">    }</span>

    @Override
    public List&lt;Player&gt; getListPlayers() {
<span class="fc" id="L73">        String sql = &quot;select * from UEFA2016&quot;;</span>
<span class="fc" id="L74">        return jdbcTemplate.query(sql, new PlayerRowMapper());</span>
    }

<span class="fc" id="L77">    private static final class PlayerRowMapper implements RowMapper&lt;Player&gt; {</span>

        @Override
        public Player mapRow(ResultSet rs, int rowNum) throws SQLException {
<span class="fc" id="L81">            Player player = new Player();</span>
<span class="fc" id="L82">            player.setName(rs.getString(&quot;name&quot;));</span>
<span class="fc" id="L83">            player.setBiography(rs.getString(&quot;bio&quot;));</span>
<span class="fc" id="L84">            player.setPhotoInclude(rs.getString(&quot;is_photo&quot;));</span>
<span class="fc" id="L85">            player.setSpecialPlayer(rs.getString(&quot;is_spec_player&quot;));</span>
<span class="fc" id="L86">            player.setPosition(rs.getString(&quot;position&quot;));</span>
<span class="fc" id="L87">            player.setNumber(String.valueOf(rs.getInt(&quot;number_player&quot;)));</span>
<span class="fc" id="L88">            player.setCaps(String.valueOf(rs.getInt(&quot;caps&quot;)));</span>
<span class="fc" id="L89">            player.setCountGoals(String.valueOf(rs.getInt(&quot;cnt_goals&quot;)));</span>
<span class="fc" id="L90">            player.setClub(rs.getString(&quot;club&quot;));</span>
<span class="fc" id="L91">            player.setLeague(rs.getString(&quot;league&quot;));</span>
<span class="fc" id="L92">            player.setDateBirthday(Utility.dateToString(rs.getDate(&quot;date_birthday&quot;)));</span>
<span class="fc" id="L93">            player.setRating_match1(rs.getString(&quot;rating_match1&quot;));</span>
<span class="fc" id="L94">            player.setRating_match2(rs.getString(&quot;rating_match2&quot;));</span>
<span class="fc" id="L95">            player.setRating_match3(rs.getString(&quot;rating_match3&quot;));</span>
<span class="fc" id="L96">            return player;</span>
        }
    }
}

</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>